---
title: "Task 4"
format: html
editor: visual
---
```{r}
# Task 4: Building a Toolkit for Your Universe (Slovak Cities)
# Data from: https://simplemaps.com/data/sk-cities

library(dplyr)
library(readxl)

# Načítanie dát (uprav názov súboru podľa potreby)
sk_cities <- read_excel("sk Task 3 dataset.xlsx", col_names = TRUE)
names(sk_cities) <- make.names(names(sk_cities), unique = TRUE) # oprava prázdnych názvov

# -------------------------------------------------------------------------
# 4.1 Greeting Function ----------------------------------------------------
welcome_to_my_universe <- function(your_name) {
  cat("--------------------------------\n")
  cat("Analysis Toolkit for Slovak Cities\n")
  cat("Report prepared by:", your_name, "\n")
  cat("--------------------------------\n")
}

# Volanie funkcie
welcome_to_my_universe("Filip")

# -------------------------------------------------------------------------
# 4.2 Loading Function -----------------------------------------------------
load_and_inspect <- function(file_path) {
  data <- read_excel(file_path, col_names = TRUE)
  names(data) <- make.names(names(data), unique = TRUE)
  cat("--- Data Loaded:", file_path, "---\n")
  print(glimpse(data))
  cat("\n--- First 6 Rows: ---\n")
  print(head(data))
  return(data)
}

# Volanie funkcie
my_data <- load_and_inspect("sk Task 3 dataset.xlsx")

# -------------------------------------------------------------------------
# 4.3 Query Function -------------------------------------------------------
# Funkcia na filtrovanie miest podľa minimálnej populácie
filter_cities_by_population <- function(data, pop_threshold) {
  result <- data %>%
    filter(population > pop_threshold) %>%
    select(city, admin_name, population) %>%
    arrange(desc(population))
  return(result)
}

# Volanie funkcie
big_cities <- filter_cities_by_population(my_data, 100000)
print(big_cities)

# -------------------------------------------------------------------------
# 4.4 Reporting Function ---------------------------------------------------
generate_report <- function(data, region_name) {
  region_data <- data %>%
    filter(admin_name == region_name)
  
  avg_pop <- mean(region_data$population, na.rm = TRUE)
  max_pop <- max(region_data$population, na.rm = TRUE)
  min_pop <- min(region_data$population, na.rm = TRUE)
  city_count <- nrow(region_data)
  
  cat("\n--- Report for Region:", region_name, "---\n")
  cat("Number of Cities:", city_count, "\n")
  cat("Average Population:", round(avg_pop, 0), "\n")
  cat("Maximum Population:", max_pop, "\n")
  cat("Minimum Population:", min_pop, "\n")
  cat("----------------------------------\n\n")
}

# Volanie funkcie pre dva regióny
generate_report(my_data, "Bratislava")
generate_report(my_data, "Nitra")
```
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
